<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pro Trading Dashboard</title>

<!-- Firebase SDKs (compat) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body{margin:0;font-family:Arial,sans-serif;background:radial-gradient(circle at top,#111827,#020617);color:#e5e7eb;}
.header{display:flex;justify-content:space-between;align-items:center;padding:12px 20px;border-bottom:1px solid #1f2937;}
.btn{padding:10px 18px;border-radius:20px;background:linear-gradient(135deg,#facc15,#f59e0b);color:#000;font-weight:bold;border:none;cursor:pointer;margin-top:5px;}
.ticker{overflow:hidden;border-bottom:1px solid #1f2937;background:linear-gradient(90deg,#1f2937,#0f172a);padding:8px 0;border-radius:8px;}
.ticker-track{display:flex;gap:40px;animation:scroll 20s linear infinite;}
.ticker span{white-space:nowrap;color:#22c55e;font-weight:bold}
@keyframes scroll{from{transform:translateX(100%)} to{transform:translateX(-100%)}}
.hero{height:60vh;display:flex;align-items:center;justify-content:center;text-align:center;}
.hero h1{font-size:3rem}
.hero p{color:#9ca3af;margin:15px 0 25px}
.dashboard{max-width:1400px;margin:auto;padding:40px 15px;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:20px;}
.card{background:#0f172a;padding:15px;border-radius:20px;box-shadow:0 0 40px rgba(0,0,0,.6);}
.card h3{text-align:center;margin-bottom:10px}
table{width:100%;border-collapse:collapse;}
th,td{padding:8px;border-bottom:1px solid #1f2937;}
.green{color:#22c55e}
.red{color:#ef4444}
footer{text-align:center;padding:20px;color:#9ca3af;}
input, select{width:100%;margin:5px 0;padding:8px;border-radius:8px;border:1px solid #ccc;background:#1f2937;color:#fff;}
</style>
</head>
<body>

<!-- HEADER -->
<div class="header">
  <strong>⚡ Pro Trading</strong>
  <div>
    <button class="btn" onclick="showLogin()">Login/Register</button>
    <button class="btn" onclick="connectWallet()">Connect Wallet</button>
  </div>
</div>

<!-- LOGIN / REGISTER FORMS -->
<div id="authForms" style="max-width:400px;margin:20px auto;display:block;">
  <div class="card">
    <h3>Register</h3>
    <input id="reg-email" type="email" placeholder="Email">
    <input id="reg-pass" type="password" placeholder="Password">
    <button class="btn" onclick="registerUser()">Register</button>
  </div>
  <div class="card" style="margin-top:10px;">
    <h3>Login</h3>
    <input id="login-email" type="email" placeholder="Email">
    <input id="login-pass" type="password" placeholder="Password">
    <button class="btn" onclick="loginUser()">Login</button>
  </div>
</div>

<!-- TICKER -->
<div class="ticker" style="display:none;" id="tickerDiv">
  <div class="ticker-track">
    <span>BTC $<b id="btc"></b></span>
    <span>ETH $<b id="eth"></b></span>
    <span>LTC $<b id="ltc"></b></span>
    <span>XRP $<b id="xrp"></b></span>
    <span>GOLD $<b id="gold"></b></span>
    <span>SILVER $<b id="silver"></b></span>
    <span>PLATINUM $<b id="platinum"></b></span>
  </div>
</div>

<!-- HERO -->
<section class="hero" id="heroDiv" style="display:none;">
<div>
<h1>All-in-One Trading Platform</h1>
<p>Charts • Portfolio • Wallet</p>
<a href="#markets"><button class="btn">Enter Dashboard</button></a>
</div>
</section>

<!-- DASHBOARD -->
<section id="markets" class="dashboard" style="display:none;">
<div class="grid">
<div class="card"><h3>Bitcoin (BTC/USD)</h3><div id="tv-btc" style="height:400px"></div></div>
<div class="card"><h3>Ethereum (ETH/USD)</h3><div id="tv-eth" style="height:400px"></div></div>
<div class="card"><h3>Litecoin (LTC/USD)</h3><div id="tv-ltc" style="height:400px"></div></div>
<div class="card"><h3>XRP (XRP/USD)</h3><div id="tv-xrp" style="height:400px"></div></div>
<div class="card"><h3>Gold (XAU/USD)</h3><div id="tv-gold" style="height:400px"></div></div>
<div class="card"><h3>Silver (XAG/USD)</h3><div id="tv-silver" style="height:400px"></div></div>
<div class="card"><h3>Platinum (XPT/USD)</h3><div id="tv-platinum" style="height:400px"></div></div>

<!-- Portfolio Table -->
<div class="card">
<h3>Portfolio & Investments</h3>
<table id="portfolioTable">
<tr><th>Asset</th><th>Amount</th><th>PnL</th></tr>
</table>
</div>

<!-- Deposit / Invest -->
<div class="card">
<h3>Deposit / Invest</h3>
<input id="deposit-amount" type="number" placeholder="Deposit Amount (USD)">
<button class="btn" onclick="deposit()">Deposit</button>
<h4>Invest in Assets</h4>
<select id="invest-asset">
  <option value="BTC">Bitcoin</option>
  <option value="ETH">Ethereum</option>
  <option value="LTC">Litecoin</option>
  <option value="XRP">XRP</option>
  <option value="GOLD">Gold</option>
  <option value="SILVER">Silver</option>
  <option value="PLATINUM">Platinum</option>
</select>
<input id="invest-amount" type="number" placeholder="Amount to Invest">
<button class="btn" onclick="invest()">Invest</button>
</div>

</div>
</section>

<footer>© 2025 Pro Trading Dashboard</footer>

<!-- TradingView -->
<script src="https://s3.tradingview.com/tv.js"></script>
<script>
function tv(id,symbol){
  new TradingView.widget({autosize:true,symbol:symbol,interval:"15",theme:"dark",style:"1",container_id:id});
}
tv("tv-btc","COINBASE:BTCUSD");
tv("tv-eth","COINBASE:ETHUSD");
tv("tv-ltc","COINBASE:LTCUSD");
tv("tv-xrp","COINBASE:XRPUSD");
tv("tv-gold","OANDA:XAUUSD");
tv("tv-silver","OANDA:XAGUSD");
tv("tv-platinum","OANDA:XPTUSD");
</script>

<!-- Live Prices -->
<script>
async function prices(){
  const d = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,litecoin,ripple&vs_currencies=usd").then(r=>r.json());
  document.getElementById("btc").innerText=d.bitcoin.usd.toLocaleString();
  document.getElementById("eth").innerText=d.ethereum.usd.toLocaleString();
  document.getElementById("ltc").innerText=d.litecoin.usd.toLocaleString();
  document.getElementById("xrp").innerText=d.ripple.usd.toLocaleString();
  document.getElementById("gold").innerText=(2350+Math.random()*5).toFixed(2);
  document.getElementById("silver").innerText=(28+Math.random()*0.5).toFixed(2);
  document.getElementById("platinum").innerText=(1020+Math.random()*5).toFixed(2);
}
prices(); setInterval(prices,8000);
</script>

<!-- Firebase Config -->
<script>
const firebaseConfig = {
apiKey: "AIzaSyB-aVVMfBNUoMWIK0ahfAG_c3wVGkpLtkM",
  authDomain: "protradingdashboard.firebaseapp.com",
  projectId: "protradingdashboard",
  storageBucket: "protradingdashboard.firebasestorage.app",
  messagingSenderId: "297586635934",
  appId: "1:297586635934:web:05a3b38f87d69d837a778f",
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

// Show login/register form
function showLogin(){ document.getElementById("authForms").style.display = "block"; }

// Register
function registerUser(){
  const email = document.getElementById("reg-email").value;
  const password = document.getElementById("reg-pass").value;
  auth.createUserWithEmailAndPassword(email,password)
    .then(userCredential=>{
      const user=userCredential.user;
      db.ref('users/'+user.uid).set({
        portfolio:{BTC:0,ETH:0,LTC:0,XRP:0,GOLD:0,SILVER:0,PLATINUM:0},
        balance:0,
        investments:{BTC:0,ETH:0,LTC:0,XRP:0,GOLD:0,SILVER:0,PLATINUM:0},
        created:new Date().toISOString()
      });
      alert("Registration successful! You can login now.");
    }).catch(e=>alert(e.message));
}

// Login
function loginUser(){
  const email = document.getElementById("login-email").value;
  const password = document.getElementById("login-pass").value;
  auth.signInWithEmailAndPassword(email,password)
    .then(userCredential=>{
      const user=userCredential.user;
      alert("Login successful!");
      document.getElementById("authForms").style.display="none";
      document.getElementById("heroDiv").style.display="block";
      document.getElementById("markets").style.display="block";
      document.getElementById("tickerDiv").style.display="block";
      loadPortfolio(user.uid);
    }).catch(e=>alert(e.message));
}

// Load portfolio table
async function loadPortfolio(uid){
  const snapshot = await db.ref('users/'+uid).get();
  if(snapshot.exists()){
    const data = snapshot.val();
    const portfolio = data.portfolio || {};
    const investments = data.investments || {};
    const balance = data.balance || 0;

    const table = document.getElementById("portfolioTable");
    table.innerHTML = `<tr><th>Asset</th><th>Amount</th><th>PnL</th></tr>
                       <tr><td colspan="2">Balance</td><td>$${balance.toFixed(2)}</td></tr>`;
    for(let asset in portfolio){
      table.innerHTML += `<tr>
        <td>${asset}</td>
        <td>${portfolio[asset]} + ${investments[asset]}</td>
        <td class="green">+0.0%</td>
      </tr>`;
    }
  }
}

// Deposit function
function deposit() {
  const amount = parseFloat(document.getElementById("deposit-amount").value);
  const user = auth.currentUser;
  if(!user || isNaN(amount) || amount<=0) return alert("Login first and enter a valid amount.");
  const userRef = db.ref('users/'+user.uid);
  userRef.child('balance').get().then(snapshot=>{
    const currentBalance = snapshot.exists()?snapshot.val():0;
    userRef.update({balance:currentBalance+amount});
    alert(`Deposit successful! New Balance: $${(currentBalance+amount).toFixed(2)}`);
    loadPortfolio(user.uid);
  });
}

// Invest function
function invest() {
  const user = auth.currentUser;
  if(!user) return alert("Login first.");
  const asset = document.getElementById("invest-asset").value;
  const amount = parseFloat(document.getElementById("invest-amount").value);
  const userRef = db.ref('users/'+user.uid);
  if(isNaN(amount) || amount<=0) return alert("Enter valid amount.");
  userRef.child('balance').get().then(snapshot=>{
    const balance = snapshot.exists()?snapshot.val():0;
    if(amount>balance) return alert("Insufficient balance.");
    const newBalance = balance - amount;
    userRef.update({balance:newBalance});
    userRef.child('investments/'+asset).get().then(snap=>{
      const currentInvestment = snap.exists()?snap.val():0;
      userRef.update({'investments/'+asset]:currentInvestment+amount});
      alert(`Invested $${amount.toFixed(2)} in ${asset}. Remaining Balance: $${newBalance.toFixed(2)}`);
      loadPortfolio(user.uid);
    });
  });
}

// Connect Wallet
async function connectWallet(){
  if(!window.ethereum){ alert("MetaMask not installed"); return; }
  const accounts = await ethereum.request({method:'eth_requestAccounts'});
  alert("Wallet connected:\n"+accounts[0]);
}
</script>

</body>
</html>
