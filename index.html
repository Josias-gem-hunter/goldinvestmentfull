<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pro Trading Dashboard</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<!-- TradingView -->
<script src="https://s3.tradingview.com/tv.js"></script>

<style>
body{margin:0;font-family:Arial;background:#0b0f1a;color:#e5e7eb}
header{text-align:center;padding:20px;font-size:24px;font-weight:bold}
.grid{max-width:1200px;margin:auto;padding:20px;display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px}
.card{background:#121826;padding:20px;border-radius:16px}
.btn{padding:12px;border:none;border-radius:12px;background:#22c55e;font-weight:bold;cursor:pointer}
input,select{width:100%;padding:10px;margin:6px 0;background:#020617;color:#fff;border:1px solid #333;border-radius:8px}
#dashboard{display:none}
table{width:100%;border-collapse:collapse}
td,th{padding:8px;border-bottom:1px solid #333}
.ticker{display:flex;gap:20px;padding:10px;border-bottom:1px solid #333}
</style>
</head>

<body>

<header>âš¡ Pro Trading Dashboard</header>

<!-- AUTH -->
<div id="authForms" class="grid">
  <div class="card">
    <h3>Register</h3>
    <input id="regEmail" placeholder="Email">
    <input id="regPass" type="password" placeholder="Password">
    <button class="btn" onclick="registerUser()">Register</button>
    <hr>
    <h3>Login</h3>
    <input id="loginEmail" placeholder="Email">
    <input id="loginPass" type="password" placeholder="Password">
    <button class="btn" onclick="loginUser()">Login</button>
  </div>
</div>

<!-- DASHBOARD -->
<div id="dashboard">

<div class="ticker">
  <span>BTC $<b id="btc">0</b></span>
  <span>ETH $<b id="eth">0</b></span>
  <span>GOLD $<b id="gold">0</b></span>
</div>

<div class="grid">
  <div class="card">
    <h3>ðŸ’Ž Invest</h3>
    <input id="investAmount" type="number" placeholder="Amount">
    <select id="investAsset">
      <option value="BTC">BTC</option>
      <option value="ETH">ETH</option>
      <option value="GOLD">GOLD</option>
    </select>
    <button class="btn" onclick="deposit()">Deposit</button>
  </div>

  <div class="card">
    <h3>ðŸ“Š Portfolio</h3>
    <table id="portfolioTable">
      <tr><th>Asset</th><th>Amount</th></tr>
    </table>
  </div>
</div>

<div class="grid">
  <div class="card" style="height:400px" id="tv-btc"></div>
  <div class="card" style="height:400px" id="tv-gold"></div>
</div>

<button class="btn" onclick="logoutUser()">Logout</button>
</div>

<script>
// ðŸ”¥ FIREBASE CONFIG (YOUR API â€“ CORRECT)
firebase.initializeApp({
  apiKey: "AIzaSyB-aVVMfBNUoMWIK0ahfAG_c3wVGkpLtkM",
  authDomain: "protradingdashboard.firebaseapp.com",
  projectId: "protradingdashboard",
  storageBucket: "protradingdashboard.firebasestorage.app",
  messagingSenderId: "297586635934",
  appId: "1:297586635934:web:05a3b38f87d69d837a778f",
  databaseURL: "https://protradingdashboard-default-rtdb.firebaseio.com"
});

const auth = firebase.auth();
const db = firebase.database();

// AUTH
function registerUser(){
  const email=document.getElementById("regEmail").value;
  const pass=document.getElementById("regPass").value;

  auth.createUserWithEmailAndPassword(email,pass).then(res=>{
    db.ref("users/"+res.user.uid).set({
      portfolio:{BTC:0,ETH:0,GOLD:0}
    });
    alert("Registered successfully!");
  }).catch(e=>alert(e.message));
}

function loginUser(){
  const email=document.getElementById("loginEmail").value;
  const pass=document.getElementById("loginPass").value;

  auth.signInWithEmailAndPassword(email,pass)
    .then(res=>showDashboard(res.user.uid))
    .catch(e=>alert(e.message));
}

function logoutUser(){
  auth.signOut();
  dashboard.style.display="none";
  authForms.style.display="grid";
}

// DASHBOARD
function showDashboard(uid){
  authForms.style.display="none";
  dashboard.style.display="block";
  loadPortfolio(uid);
  loadCharts();
}

// PORTFOLIO
async function loadPortfolio(uid){
  const snap=await db.ref("users/"+uid+"/portfolio").get();
  portfolioTable.innerHTML='<tr><th>Asset</th><th>Amount</th></tr>';
  const p=snap.val();
  for(let k in p){
    portfolioTable.innerHTML+=`<tr><td>${k}</td><td>${p[k]}</td></tr>`;
  }
}

// DEPOSIT (SIMULATION)
async function deposit(){
  const u=auth.currentUser;
  const asset=document.getElementById("investAsset").value;
  const amount=parseFloat(document.getElementById("investAmount").value);

  const ref=db.ref("users/"+u.uid+"/portfolio/"+asset);
  const cur=(await ref.get()).val()||0;
  ref.set(cur+amount);
  loadPortfolio(u.uid);
}

// PRICES
async function prices(){
  const d=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum&vs_currencies=usd").then(r=>r.json());
  btc.innerText=d.bitcoin.usd;
  eth.innerText=d.ethereum.usd;
  gold.innerText=(2350+Math.random()*5).toFixed(2);
}
prices(); setInterval(prices,8000);

// CHARTS
function loadCharts(){
  new TradingView.widget({container_id:"tv-btc",symbol:"BTCUSD",theme:"dark"});
  new TradingView.widget({container_id:"tv-gold",symbol:"XAUUSD",theme:"dark"});
}
</script>

</body>
</html>
